{% extends 'base.html.twig' %}

{% block title %}Congés en attente{% endblock %}

{% block body %}

    {% if congesEnAttente is empty %}
        <p>Aucun congé en attente.</p>
    {% else %}
        <ul>
            {% for conge in congesEnAttente %}
                <li>
                    {{ conge.user.prenom }} :
                    du {{ conge.debut|date('d/m/Y') }} au {{ conge.fin|date('d/m/Y') }}
                    ({{ conge.motif ?? 'Pas de raison spécifiée' }})
                    
                    <form method="post" action="{{ path('update_conge_status', {'id': conge.id}) }}">
                        <select class="form-select" name="status" onchange="this.form.submit()">
                            <option value="en attente" {{ conge.status == 'attente' ? 'selected' : '' }}>En attente</option>
                            <option value="approuvé" {{ conge.status == 'approuvé' ? 'selected' : '' }}>Approuvé</option>
                            <option value="rejecté" {{ conge.status == 'rejecté' ? 'selected' : '' }}>Rejeté</option>
                        </select>
                        <input type="hidden" name="_token" value="{{ csrf_token('update_conge_' ~ conge.id) }}">
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

{% endblock %}